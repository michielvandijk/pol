setwd("C:/Users/Tomas/Documents/LEI/data/TZA")
list.files()
geoDir1 <- "C:/Users/Tomas/Documents/LEI/data/TZA/TZNPS2GEODTA/HH.Geovariables_Y2.dta"
geoDir2 <- "C:/Users/Tomas/Documents/LEI/data/TZA/TZA_2012_LSMS_v01_M_STATA_English_labels"
gps1 <- read_dta(geoDir1) %>%
select(y2_hhid, longitude=lon_modified, latitude=lat_modified)
library(rgdal)
library(haven)
library(dplyr)
geoDir1 <- "C:/Users/Tomas/Documents/LEI/data/TZA/TZNPS2GEODTA/HH.Geovariables_Y2.dta"
geoDir2 <- "C:/Users/Tomas/Documents/LEI/data/TZA/TZA_2012_LSMS_v01_M_STATA_English_labels"
gps1 <- read_dta(geoDir1) %>%
select(y2_hhid, longitude=lon_modified, latitude=lat_modified)
gps2 <- read_dta(geoDir2) %>%
select(y2_hhid, longitude=lon_modified, latitude=lat_modified)
setwd("C:/Users/Tomas/Documents/LEI/data/TZA/TZA_2012_LSMS_v01_M_STATA_English_labels")
list.files()
geoDir2 <- "C:/Users/Tomas/Documents/LEI/data/TZA/TZA_2012_LSMS_v01_M_STATA_English_labels/HouseholdGeovars_Y3.dta"
gps2 <- read_dta(geoDir2) %>%
select(y2_hhid, longitude=lon_modified, latitude=lat_modified)
gps2 <- read_dta(geoDir2) %>%
select(y3_hhid, longitude=lon_modified, latitude=lat_modified)
gps2 <- read_dta(geoDir2)
head(gps2)
gps1 <- read_dta(geoDir1) %>%
select(y2_hhid, longitude=lon_modified, latitude=lat_modified)
gps2 <- read_dta(geoDir2) %>%
select(y3_hhid, longitude=lon_dd_mod, latitude=lat_dd_mod)
setwd("C:/Users/Tomas/Documents")
TZA <- readRDS("GADM_2.7_TZA_adm3.rds")
llCRS <- CRS(proj4string(TZA))
gps_mat <- cbind(gps1$longitude, gps1$latitude)
row.names(gps_mat) <- 1:nrow(gps_mat)
sp <- SpatialPoints(gps_mat, llCRS)
wards2010 <- over(sp, TZA) %>%
select(reg=NAME_1, dis=NAME_2, ward=NAME_3) %>%
unique
gps_mat <- cbind(gps2$longitude, gps2$latitude)
row.names(gps_mat) <- 1:nrow(gps_mat)
sp <- SpatialPoints(gps_mat, llCRS)
wards2012 <- over(sp, TZA) %>%
select(reg=NAME_1, dis=NAME_2, ward=NAME_3) %>%
unique
head(wards2012)
head(wards2010)
dim(wards2012)
dim(wards2010)
summary(wards2012)
islands <- c("Kaskazini-Unguja", "Zanzibar South and Central", "Zanzibar West",
"Kaskazini-Pemba", "Kusini-Pemba")
wards2010 <- wards2010[!toupper(wards2010$reg) %in% toupper(islands),]
unique(wards2012$reg)
wards2012 <- wards2012[!toupper(wards2012$reg) %in% toupper(islands),]
dim(wards2012)
unique(wards2012$reg)
table(!wards2012$ward %in% wards2010$ward)
table(!wards2012$reg %in% wards2010$reg)
table(wards2012$reg %in% wards2010$reg)
table(wards2012$dis %in% wards2010$dis)
wards <- rbind(wards2010, wards2012) %>% unique
dim(wards)
setwd("C:/Users/Tomas/Documents/LEI/pol/data")
pol_data2 <- read.csv("pol_data2")
pol_data2 <- read.csv("pol_data2.csv", header=TRUE)
head(wards)
head(pol_data2)
wards$reg <- toupper(wards$reg)
wards$dis <- toupper(wards$dis)
wards$ward <- toupper(wards$ward)
pol_data3 <- left_join(wards, pol_data2)
dim(pol_data3)
head(pol_data3)
wards$id <- NULL
pol_data3 <- left_join(wards, pol_data2)
head(pol_data3)
summary(pol_data3)
write.csv(pol_data3, "pol_data3.csv", row.names=FALSE)
pol_data2$id <- NULL
pol_data3 <- left_join(wards, pol_data2)
dim(pol_data3)
pol_data3 <- pol_data3[, c(8, 1:7)]
pol_data3 <- left_join(wards, pol_data2)
pol_data3$id - 1:nrow(pol_data3)
pol_data3$id <- 1:nrow(pol_data3)
pol_data3 <- pol_data3[, c(9, 1:8)]
head(pol_data3)
write.csv(pol_data3, "pol_data3.csv", row.names=FALSE)
write.csv(pol_data3, "pol_data3.csv", row.names=FALSE)
head(pol_data3)
pol_data3 <- left_join(wards, pol_data2)
pol_data3$id <- 1:nrow(pol_data3)
pol_data3 <- pol_data3[, c(9,1,2,4,3)]
write.csv(pol_data3, "pol_data3.csv", row.names=FALSE)
write.csv(pol_data3, "pol_data3.csv", row.names=FALSE)
